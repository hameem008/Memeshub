-- NO 
-- NO 
-- NO 
-- NO 
-- NO 
-- NO 
CREATE USER MEMESHUB IDENTIFIED BY LetsCode;
GRANT UNLIMITED TABLESPACE TO MEMESHUB;
GRANT ALTER ON TABLESPACE users TO MEMESHUB;
GRANT ALL PRIVILEGES TO MEMESHUB; 
CREATE TABLE User_Info (
	User_ID NUMBER(10) NOT NULL,
	Email VARCHAR2(50) NOT NULL,
	Password VARCHAR2(20) NOT NULL,
	Name VARCHAR2(50) NOT NULL,
	Profile_Picture VARCHAR2(1000),
	Description VARCHAR2(1000),
	Earned_Money NUMBER(20),
	Social_Media_Handle VARCHAR2(50),
	PRIMARY KEY(User_ID)
);
CREATE TABLE Follow (
	Figure NUMBER(10) NOT NULL,
	Follower NUMBER(10) NOT NULL,
	PRIMARY KEY(Figure,Follower),
	FOREIGN KEY(Figure) References USER_INFO (User_ID) ,
	FOREIGN KEY(Follower) References USER_INFO (User_ID)
);
DROP TABLE FOLLOW;
CREATE TABLE Sponser_Info(
	Sponser_ID NUMBER(10) NOT NULL,
	Name VARCHAR2(20) NOT NULL,
	Walpaper VARCHAR2(1000),
	Logo VARCHAR2(1000),
	PRIMARY KEY(Sponser_ID)
);
CREATE TABLE Templates_Info(
	Template_ID NUMBER(10),
	Content VARCHAR2(1000),
	Uploaded_By NUMBER(10),
	PRIMARY KEY(Template_ID),
	FOREIGN KEY(Uploaded_By) References USER_INFO(User_ID)
);
CREATE TABLE Community_Info(
	Community_ID NUMBER(10) NOT NULL,
	Name VARCHAR2(50) NOT NULL,
	Admin_ID NUMBER(10),
	Community_Image VARCHAR2(1000),
	PRIMARY KEY(Community_ID),
	FOREIGN KEY(Admin_ID) References USER_INFO(User_ID)
);
DROP TABLE COMMUNITY_INFO;
CREATE TABLE Contest_Info(
	Contest_ID NUMBER(10) NOT NULL,
	Host_ID NUMBER(10) NOT NULL,
	Contest_Name VARCHAR2(20) NOT NULL,
	Sponser_ID NUMBER(10) NOT NULL,
	Prize_Money NUMBER(10),
	Start_Time DATE,
	End_Time DATE,
	Registration_Fee NUMBER(10),
	PRIMARY KEY(Contest_ID),
	FOREIGN KEY(Sponser_ID) References SPONSER_INFO (Sponser_ID),
	FOREIGN KEY(Host_ID) References USER_INFO (User_ID)
);
CREATE TABLE Contest_Registration(
	Contest_ID NUMBER(10) NOT NULL,
	Memer_ID NUMBER(10) NOT NULL,
	Rank NUMBER(10),
	PRIMARY KEY(Contest_ID,Memer_ID),
	FOREIGN KEY(Contest_ID) References CONTEST_INFO (Contest_ID),
	FOREIGN KEY(Memer_ID) References USER_INFO (User_ID)
);
CREATE TABLE Post_Info (
	Post_ID NUMBER(10) NOT NULL,
	Community_ID NUMBER(10),
	Contest_ID NUMBER(10),
	Author_ID NUMBER(10) NOT NULL,
	Description VARCHAR2(1000),
	Tag VARCHAR2(100),
	Meme VARCHAR2(50),
	Post_Time DATE,
	PRIMARY KEY(Post_ID),
	FOREIGN KEY(Author_ID) References USER_INFO (User_ID),
	FOREIGN KEY(Contest_ID) References CONTEST_INFO (Contest_ID),
	FOREIGN KEY(Community_ID) References COMMUNITY_INFO (Community_ID)
);
DROP TABLE POST_INFO;
CREATE TABLE Activities(
	Comment_ID NUMBER(10) NOT NULL,
	Post_ID NUMBER(10) NOT NULL,
	Author_ID NUMBER(10) NOT NULL,
	Time DATE,
	Description VARCHAR2(1000),
	PRIMARY KEY(Comment_ID),
	FOREIGN KEY(Post_ID) References POST_INFO(Post_ID),
	FOREIGN KEY(Author_ID) References USER_INFO (User_ID)
);
DROP TABLE ACTIVITIES;
CREATE TABLE Up_Vote (
	Post_ID NUMBER(10) NOT NULL,
	Author_ID NUMBER(10) NOT NULL,
	PRIMARY KEY(Post_ID,Author_ID),
	FOREIGN KEY(Post_ID) References POST_INFO (Post_ID),
	FOREIGN KEY(Author_ID) References USER_INFO (User_ID)
);
DROP TABLE UP_VOTE;
CREATE TABLE Community(
	Community_ID NUMBER(10),
	Member_ID NUMBER(10),
	PRIMARY KEY(Community_ID,Member_ID),
	FOREIGN KEY(Member_ID) References USER_INFO(User_ID),
	FOREIGN KEY(Community_ID) References COMMUNITY_INFO(Community_ID) 
);
DROP TABLE COMMUNITY; 
CREATE TABLE Next_Valid_IDs(
	User_ID NUMBER(10),
	Post_ID NUMBER(10),
	Contest_ID NUMBER(10),
	Community_ID NUMBER(10),
	Sponser_ID NUMBER(10),
	Template_ID NUMBER(10),
	Comment_ID NUMBER(10)
);
DROP TABLE NEXT_VALID_IDS;
INSERT INTO NEXT_VALID_IDS VALUES(11,41,4,4,6,9,201);
-- user_info
-- (USER_ID,EMAIL,PASSWORD,NAME,PROFILE_PICTURE,EARNED_MONEY,SOCIAL_MEDIA_HANDLE)
INSERT INTO User_Info VALUES (1,'hameem@gmail.com','hameempass','hameem',NULL,NULL,0,'hameem');
INSERT INTO User_Info VALUES (2,'awesh@gmail.com','aweshpass','awesh',NULL,NULL,0,'awesh');
INSERT INTO User_Info VALUES (3,'fihad@gmail.com','fihadpass','fihad',NULL,NULL,0,'fihad');
INSERT INTO User_Info VALUES (4,'zisan@gmail.com','zisanpass','zisan',NULL,NULL,0,'zisan');
INSERT INTO User_Info VALUES (5,'ayon@gmail.com','ayonpass','ayon',NULL,NULL,0,'ayon');
INSERT INTO User_Info VALUES (6,'takia@gmail.com','takiapass','takia',NULL,NULL,0,'takia');
INSERT INTO User_Info VALUES (7,'suhash@gmail.com','suhashpass','suhash',NULL,NULL,0,'suhash');
INSERT INTO User_Info VALUES (8,'prithu@gmail.com','prithupass','prithu',NULL,NULL,0,'prithu');
INSERT INTO User_Info VALUES (9,'udoy@gmail.com','udoypass','udoy',NULL,NULL,0,'udoy');
INSERT INTO User_Info VALUES (10,'taky@gmail.com','takypass','taky',NULL,NULL,0,'taky');
-- follow 
-- (FIGURE,FOLLOWER)
INSERT INTO Follow VALUES(1,2);
INSERT INTO Follow VALUES(1,3);
INSERT INTO Follow VALUES(1,4);
INSERT INTO Follow VALUES(1,5);
INSERT INTO Follow VALUES(1,6);
INSERT INTO Follow VALUES(1,7);
INSERT INTO Follow VALUES(1,8);
INSERT INTO Follow VALUES(1,9);
INSERT INTO Follow VALUES(1,10);
INSERT INTO Follow VALUES(2,1);
INSERT INTO Follow VALUES(2,3);
INSERT INTO Follow VALUES(2,4);
INSERT INTO Follow VALUES(2,5);
INSERT INTO Follow VALUES(2,6);
INSERT INTO Follow VALUES(2,7);
INSERT INTO Follow VALUES(2,8);
INSERT INTO Follow VALUES(2,9);
INSERT INTO Follow VALUES(2,10);
INSERT INTO Follow VALUES(3,1);
INSERT INTO Follow VALUES(3,2);
INSERT INTO Follow VALUES(3,4);
INSERT INTO Follow VALUES(3,5);
INSERT INTO Follow VALUES(3,6);
INSERT INTO Follow VALUES(3,7);
INSERT INTO Follow VALUES(3,8);
INSERT INTO Follow VALUES(3,9);
INSERT INTO Follow VALUES(3,10);
INSERT INTO Follow VALUES(4,1);
INSERT INTO Follow VALUES(4,2);
INSERT INTO Follow VALUES(4,3);
INSERT INTO Follow VALUES(4,5);
INSERT INTO Follow VALUES(4,6);
INSERT INTO Follow VALUES(4,7);
INSERT INTO Follow VALUES(4,8);
INSERT INTO Follow VALUES(4,9);
INSERT INTO Follow VALUES(4,10);
INSERT INTO Follow VALUES(5,1);
INSERT INTO Follow VALUES(5,2);
INSERT INTO Follow VALUES(5,3);
INSERT INTO Follow VALUES(5,4);
INSERT INTO Follow VALUES(5,6);
INSERT INTO Follow VALUES(5,7);
INSERT INTO Follow VALUES(5,8);
INSERT INTO Follow VALUES(5,9);
INSERT INTO Follow VALUES(5,10);
INSERT INTO Follow VALUES(6,1);
INSERT INTO Follow VALUES(6,2);
INSERT INTO Follow VALUES(6,3);
INSERT INTO Follow VALUES(6,4);
INSERT INTO Follow VALUES(6,5);
INSERT INTO Follow VALUES(6,7);
INSERT INTO Follow VALUES(6,8);
INSERT INTO Follow VALUES(6,9);
INSERT INTO Follow VALUES(6,10);
INSERT INTO Follow VALUES(7,1);
INSERT INTO Follow VALUES(7,2);
INSERT INTO Follow VALUES(7,3);
INSERT INTO Follow VALUES(7,4);
INSERT INTO Follow VALUES(7,5);
INSERT INTO Follow VALUES(7,6);
INSERT INTO Follow VALUES(7,8);
INSERT INTO Follow VALUES(7,9);
INSERT INTO Follow VALUES(7,10);
INSERT INTO Follow VALUES(8,1);
INSERT INTO Follow VALUES(8,2);
INSERT INTO Follow VALUES(8,3);
INSERT INTO Follow VALUES(8,4);
INSERT INTO Follow VALUES(8,5);
INSERT INTO Follow VALUES(8,6);
INSERT INTO Follow VALUES(8,7);
INSERT INTO Follow VALUES(8,9);
INSERT INTO Follow VALUES(8,10);
INSERT INTO Follow VALUES(9,1);
INSERT INTO Follow VALUES(9,2);
INSERT INTO Follow VALUES(9,3);
INSERT INTO Follow VALUES(9,4);
INSERT INTO Follow VALUES(9,5);
INSERT INTO Follow VALUES(9,6);
INSERT INTO Follow VALUES(9,7);
INSERT INTO Follow VALUES(9,8);
INSERT INTO Follow VALUES(9,10);
INSERT INTO Follow VALUES(10,1);
INSERT INTO Follow VALUES(10,2);
INSERT INTO Follow VALUES(10,3);
INSERT INTO Follow VALUES(10,4);
INSERT INTO Follow VALUES(10,5);
INSERT INTO Follow VALUES(10,6);
INSERT INTO Follow VALUES(10,7);
INSERT INTO Follow VALUES(10,8);
INSERT INTO Follow VALUES(10,9);
-- sponser 
-- (SPONSER_ID,NAME,WALPAPER,LOGO)
INSERT INTO Sponser_Info VALUES(1,'banglalink',NULL,NULL);
INSERT INTO Sponser_Info VALUES(2,'foodpanda',NULL,NULL);
INSERT INTO Sponser_Info VALUES(3,'asus',NULL,NULL);
INSERT INTO Sponser_Info VALUES(4,'gigabite',NULL,NULL);
INSERT INTO Sponser_Info VALUES(5,'robi',NULL,NULL);
-- community_info 
-- (COMMUNITY_ID,NAME,ADMIN_ID,COMMUNITY_IMAGE)
DELETE FROM Community_Info;
INSERT INTO Community_Info VALUES(1,'usbhaius',1,NULL);
INSERT INTO Community_Info VALUES(2,'cheemsfan',2,NULL);
INSERT INTO Community_Info VALUES(3,'darkhumour',2,NULL);
-- community 
-- (COMMUNITY_ID,MEMBER_ID)
DELETE FROM Community;
INSERT INTO Community VALUES(1,1);
INSERT INTO Community VALUES(1,2);
INSERT INTO Community VALUES(1,6);
INSERT INTO Community VALUES(1,10);
INSERT INTO Community VALUES(2,1);
INSERT INTO Community VALUES(2,2);
INSERT INTO Community VALUES(2,5);
INSERT INTO Community VALUES(2,6);
INSERT INTO Community VALUES(3,1);
INSERT INTO Community VALUES(3,2);
INSERT INTO Community VALUES(3,4);
-- templates_info 
-- (TEMPLATE_ID,CONTENT,UPLOADED_BY)
INSERT INTO Templates_Info VALUES(1,NULL,1);
INSERT INTO Templates_Info VALUES(2,NULL,2);
INSERT INTO Templates_Info VALUES(3,NULL,7);
INSERT INTO Templates_Info VALUES(4,NULL,2);
INSERT INTO Templates_Info VALUES(5,NULL,10);
INSERT INTO Templates_Info VALUES(6,NULL,1);
INSERT INTO Templates_Info VALUES(7,NULL,8);
INSERT INTO Templates_Info VALUES(8,NULL,1);
-- contest_info 
-- (CONTEST_ID,HOST_ID,CONTEST_NAME,SPONSER_ID,PRIZE_MONEY,START_TIME,END_TIME,REGISTRATION_FEE)
DELETE FROM Contest_Info;
INSERT INTO Contest_Info VALUES (1,2,'ungabunga',1,10000,TIMESTAMP '2023-07-13 08:00:00',TIMESTAMP '2023-07-20 17:30:00',50);
INSERT INTO Contest_Info VALUES (2,1,'ripcheems',2,20000,TIMESTAMP '2023-08-14 08:00:00',TIMESTAMP '2023-08-22 17:30:00',75);
INSERT INTO Contest_Info VALUES (3,6,'goodbye',5,50000,TIMESTAMP '2023-08-22 08:00:00',TIMESTAMP '2023-12-01 17:30:00',0);
-- Contest Registration 
-- (CNTEST_ID,MEMER_ID,RANK)
INSERT INTO Contest_Registration VALUES(1,1,0);
INSERT INTO Contest_Registration VALUES(1,2,0);
INSERT INTO Contest_Registration VALUES(1,3,0);
INSERT INTO Contest_Registration VALUES(1,4,0);
INSERT INTO Contest_Registration VALUES(1,5,0);
INSERT INTO Contest_Registration VALUES(2,2,0);
INSERT INTO Contest_Registration VALUES(2,4,0);
INSERT INTO Contest_Registration VALUES(2,5,0);
INSERT INTO Contest_Registration VALUES(2,6,0);
INSERT INTO Contest_Registration VALUES(2,7,0);
INSERT INTO Contest_Registration VALUES(3,1,0);
INSERT INTO Contest_Registration VALUES(3,2,0);
INSERT INTO Contest_Registration VALUES(3,3,0);
INSERT INTO Contest_Registration VALUES(3,4,0);
INSERT INTO Contest_Registration VALUES(3,5,0);
INSERT INTO Contest_Registration VALUES(3,6,0);
INSERT INTO Contest_Registration VALUES(3,7,0);
INSERT INTO Contest_Registration VALUES(3,8,0);
INSERT INTO Contest_Registration VALUES(3,9,0);
INSERT INTO Contest_Registration VALUES(3,10,0);
-- post_info
-- (POST_ID,COMMUNITY_ID,CONTEST_ID,AUTHOR_ID,DESCRIPTION,TAG,MEME,POST_TIME)
DELETE FORM POST_INFO;
INSERT INTO Post_Info VALUES(1,NULL,1,1,NULL,NULL,NULL,TIMESTAMP '2023-07-14 09:00:00');
INSERT INTO Post_Info VALUES(2,NULL,1,1,NULL,NULL,NULL,TIMESTAMP '2023-07-15 10:00:00');
INSERT INTO Post_Info VALUES(3,NULL,1,2,NULL,NULL,NULL,TIMESTAMP '2023-07-16 01:00:00');
INSERT INTO Post_Info VALUES(4,NULL,1,2,NULL,NULL,NULL,TIMESTAMP '2023-07-14 12:00:00');
INSERT INTO Post_Info VALUES(5,NULL,1,3,NULL,NULL,NULL,TIMESTAMP '2023-07-15 09:00:00');
INSERT INTO Post_Info VALUES(6,NULL,1,3,NULL,NULL,NULL,TIMESTAMP '2023-07-16 09:00:00');
INSERT INTO Post_Info VALUES(7,NULL,1,4,NULL,NULL,NULL,TIMESTAMP '2023-07-14 16:00:00');
INSERT INTO Post_Info VALUES(8,NULL,1,4,NULL,NULL,NULL,TIMESTAMP '2023-07-15 17:00:00');
INSERT INTO Post_Info VALUES(9,NULL,1,5,NULL,NULL,NULL,TIMESTAMP '2023-07-18 23:00:00');
INSERT INTO Post_Info VALUES(10,NULL,1,5,NULL,NULL,NULL,TIMESTAMP '2023-07-16 14:00:00');
INSERT INTO Post_Info VALUES(11,NULL,2,2,NULL,NULL,NULL,TIMESTAMP '2023-08-17 14:00:00');
INSERT INTO Post_Info VALUES(12,NULL,2,2,NULL,NULL,NULL,TIMESTAMP '2023-08-16 14:00:00');
INSERT INTO Post_Info VALUES(13,NULL,2,4,NULL,NULL,NULL,TIMESTAMP '2023-08-17 14:00:00');
INSERT INTO Post_Info VALUES(14,NULL,2,4,NULL,NULL,NULL,TIMESTAMP '2023-08-18 18:00:00');
INSERT INTO Post_Info VALUES(15,NULL,2,5,NULL,NULL,NULL,TIMESTAMP '2023-08-17 02:00:00');
INSERT INTO Post_Info VALUES(16,NULL,2,5,NULL,NULL,NULL,TIMESTAMP '2023-08-15 02:00:00');
INSERT INTO Post_Info VALUES(17,NULL,2,6,NULL,NULL,NULL,TIMESTAMP '2023-08-17 02:00:00');
INSERT INTO Post_Info VALUES(18,NULL,2,6,NULL,NULL,NULL,TIMESTAMP '2023-08-17 02:00:00');
INSERT INTO Post_Info VALUES(19,NULL,2,7,NULL,NULL,NULL,TIMESTAMP '2023-08-15 02:00:00');
INSERT INTO Post_Info VALUES(20,NULL,2,7,NULL,NULL,NULL,TIMESTAMP '2023-08-17 04:00:00');
INSERT INTO Post_Info VALUES(21,NULL,3,1,NULL,NULL,NULL,TIMESTAMP '2023-08-30 01:00:00');
INSERT INTO Post_Info VALUES(22,NULL,3,2,NULL,NULL,NULL,TIMESTAMP '2023-08-29 02:00:00');
INSERT INTO Post_Info VALUES(23,NULL,3,3,NULL,NULL,NULL,TIMESTAMP '2023-08-28 03:00:00');
INSERT INTO Post_Info VALUES(24,NULL,3,4,NULL,NULL,NULL,TIMESTAMP '2023-08-27 04:00:00');
INSERT INTO Post_Info VALUES(25,NULL,3,5,NULL,NULL,NULL,TIMESTAMP '2023-08-26 05:00:00');
INSERT INTO Post_Info VALUES(26,NULL,3,6,NULL,NULL,NULL,TIMESTAMP '2023-08-25 06:00:00');
INSERT INTO Post_Info VALUES(27,NULL,3,7,NULL,NULL,NULL,TIMESTAMP '2023-08-24 07:00:00');
INSERT INTO Post_Info VALUES(28,NULL,3,8,NULL,NULL,NULL,TIMESTAMP '2023-09-01 08:00:00');
INSERT INTO Post_Info VALUES(29,NULL,3,9,NULL,NULL,NULL,TIMESTAMP '2023-09-02 09:00:00');
INSERT INTO Post_Info VALUES(30,NULL,3,10,NULL,NULL,NULL,TIMESTAMP '2023-09-03 10:00:00');
INSERT INTO Post_Info VALUES(31,1,NULL,1,NULL,NULL,NULL,TIMESTAMP '2023-09-01 02:00:00');
INSERT INTO Post_Info VALUES(32,1,NULL,2,NULL,NULL,NULL,TIMESTAMP '2023-09-04 02:00:00');
INSERT INTO Post_Info VALUES(33,1,NULL,6,NULL,NULL,NULL,TIMESTAMP '2023-09-12 02:00:00');
INSERT INTO Post_Info VALUES(34,1,NULL,10,NULL,NULL,NULL,TIMESTAMP '2023-09-05 02:00:00');
INSERT INTO Post_Info VALUES(35,2,NULL,1,NULL,NULL,NULL,TIMESTAMP '2023-10-01 02:00:00');
INSERT INTO Post_Info VALUES(36,2,NULL,2,NULL,NULL,NULL,TIMESTAMP '2023-10-03 02:00:00');
INSERT INTO Post_Info VALUES(37,2,NULL,5,NULL,NULL,NULL,TIMESTAMP '2023-10-05 02:00:00');
INSERT INTO Post_Info VALUES(38,2,NULL,6,NULL,NULL,NULL,TIMESTAMP '2023-10-07 02:00:00');
INSERT INTO Post_Info VALUES(39,3,NULL,1,NULL,NULL,NULL,TIMESTAMP '2023-11-01 02:00:00');
INSERT INTO Post_Info VALUES(40,3,NULL,2,NULL,NULL,NULL,TIMESTAMP '2023-11-04 02:00:00');
-- up_vote 
-- (POST_ID,AUTHOR_ID)
DELETE FORM UP_VOTE;
INSERT INTO Up_Vote VALUES(1,1);
INSERT INTO Up_Vote VALUES(1,10);
INSERT INTO Up_Vote VALUES(1,2);
INSERT INTO Up_Vote VALUES(1,3);
INSERT INTO Up_Vote VALUES(1,4);
INSERT INTO Up_Vote VALUES(1,7);
INSERT INTO Up_Vote VALUES(1,8);
INSERT INTO Up_Vote VALUES(1,9);
INSERT INTO Up_Vote VALUES(10,1);
INSERT INTO Up_Vote VALUES(10,2);
INSERT INTO Up_Vote VALUES(10,4);
INSERT INTO Up_Vote VALUES(10,5);
INSERT INTO Up_Vote VALUES(10,6);
INSERT INTO Up_Vote VALUES(10,7);
INSERT INTO Up_Vote VALUES(10,8);
INSERT INTO Up_Vote VALUES(11,1);
INSERT INTO Up_Vote VALUES(11,2);
INSERT INTO Up_Vote VALUES(11,5);
INSERT INTO Up_Vote VALUES(11,6);
INSERT INTO Up_Vote VALUES(11,7);
INSERT INTO Up_Vote VALUES(11,8);
INSERT INTO Up_Vote VALUES(11,9);
INSERT INTO Up_Vote VALUES(12,1);
INSERT INTO Up_Vote VALUES(12,2);
INSERT INTO Up_Vote VALUES(12,3);
INSERT INTO Up_Vote VALUES(12,4);
INSERT INTO Up_Vote VALUES(12,6);
INSERT INTO Up_Vote VALUES(13,10);
INSERT INTO Up_Vote VALUES(13,2);
INSERT INTO Up_Vote VALUES(13,3);
INSERT INTO Up_Vote VALUES(13,4);
INSERT INTO Up_Vote VALUES(13,5);
INSERT INTO Up_Vote VALUES(13,7);
INSERT INTO Up_Vote VALUES(13,8);
INSERT INTO Up_Vote VALUES(13,9);
INSERT INTO Up_Vote VALUES(14,10);
INSERT INTO Up_Vote VALUES(14,3);
INSERT INTO Up_Vote VALUES(14,6);
INSERT INTO Up_Vote VALUES(14,8);
INSERT INTO Up_Vote VALUES(14,9);
INSERT INTO Up_Vote VALUES(15,1);
INSERT INTO Up_Vote VALUES(15,2);
INSERT INTO Up_Vote VALUES(15,4);
INSERT INTO Up_Vote VALUES(15,5);
INSERT INTO Up_Vote VALUES(15,6);
INSERT INTO Up_Vote VALUES(15,7);
INSERT INTO Up_Vote VALUES(15,8);
INSERT INTO Up_Vote VALUES(16,1);
INSERT INTO Up_Vote VALUES(16,2);
INSERT INTO Up_Vote VALUES(16,3);
INSERT INTO Up_Vote VALUES(16,4);
INSERT INTO Up_Vote VALUES(16,6);
INSERT INTO Up_Vote VALUES(16,7);
INSERT INTO Up_Vote VALUES(16,8);
INSERT INTO Up_Vote VALUES(16,9);
INSERT INTO Up_Vote VALUES(17,10);
INSERT INTO Up_Vote VALUES(17,4);
INSERT INTO Up_Vote VALUES(17,5);
INSERT INTO Up_Vote VALUES(17,7);
INSERT INTO Up_Vote VALUES(17,8);
INSERT INTO Up_Vote VALUES(18,1);
INSERT INTO Up_Vote VALUES(18,5);
INSERT INTO Up_Vote VALUES(18,8);
INSERT INTO Up_Vote VALUES(18,9);
INSERT INTO Up_Vote VALUES(19,1);
INSERT INTO Up_Vote VALUES(19,10);
INSERT INTO Up_Vote VALUES(19,2);
INSERT INTO Up_Vote VALUES(19,3);
INSERT INTO Up_Vote VALUES(19,5);
INSERT INTO Up_Vote VALUES(19,6);
INSERT INTO Up_Vote VALUES(19,8);
INSERT INTO Up_Vote VALUES(19,9);
INSERT INTO Up_Vote VALUES(2,1);
INSERT INTO Up_Vote VALUES(2,10);
INSERT INTO Up_Vote VALUES(2,3);
INSERT INTO Up_Vote VALUES(2,4);
INSERT INTO Up_Vote VALUES(2,5);
INSERT INTO Up_Vote VALUES(2,6);
INSERT INTO Up_Vote VALUES(2,9);
INSERT INTO Up_Vote VALUES(20,2);
INSERT INTO Up_Vote VALUES(20,3);
INSERT INTO Up_Vote VALUES(20,5);
INSERT INTO Up_Vote VALUES(20,6);
INSERT INTO Up_Vote VALUES(20,8);
INSERT INTO Up_Vote VALUES(20,9);
INSERT INTO Up_Vote VALUES(21,1);
INSERT INTO Up_Vote VALUES(21,2);
INSERT INTO Up_Vote VALUES(21,5);
INSERT INTO Up_Vote VALUES(21,6);
INSERT INTO Up_Vote VALUES(21,9);
INSERT INTO Up_Vote VALUES(22,10);
INSERT INTO Up_Vote VALUES(22,2);
INSERT INTO Up_Vote VALUES(22,4);
INSERT INTO Up_Vote VALUES(22,5);
INSERT INTO Up_Vote VALUES(22,6);
INSERT INTO Up_Vote VALUES(22,7);
INSERT INTO Up_Vote VALUES(22,8);
INSERT INTO Up_Vote VALUES(23,1);
INSERT INTO Up_Vote VALUES(23,10);
INSERT INTO Up_Vote VALUES(23,3);
INSERT INTO Up_Vote VALUES(23,4);
INSERT INTO Up_Vote VALUES(23,5);
INSERT INTO Up_Vote VALUES(23,6);
INSERT INTO Up_Vote VALUES(23,7);
INSERT INTO Up_Vote VALUES(23,9);
INSERT INTO Up_Vote VALUES(24,10);
INSERT INTO Up_Vote VALUES(24,2);
INSERT INTO Up_Vote VALUES(24,4);
INSERT INTO Up_Vote VALUES(24,5);
INSERT INTO Up_Vote VALUES(24,6);
INSERT INTO Up_Vote VALUES(24,7);
INSERT INTO Up_Vote VALUES(24,9);
INSERT INTO Up_Vote VALUES(25,10);
INSERT INTO Up_Vote VALUES(25,2);
INSERT INTO Up_Vote VALUES(25,3);
INSERT INTO Up_Vote VALUES(25,4);
INSERT INTO Up_Vote VALUES(25,5);
INSERT INTO Up_Vote VALUES(25,6);
INSERT INTO Up_Vote VALUES(25,9);
INSERT INTO Up_Vote VALUES(26,1);
INSERT INTO Up_Vote VALUES(26,10);
INSERT INTO Up_Vote VALUES(26,2);
INSERT INTO Up_Vote VALUES(26,3);
INSERT INTO Up_Vote VALUES(26,5);
INSERT INTO Up_Vote VALUES(26,6);
INSERT INTO Up_Vote VALUES(26,7);
INSERT INTO Up_Vote VALUES(26,8);
INSERT INTO Up_Vote VALUES(26,9);
INSERT INTO Up_Vote VALUES(27,2);
INSERT INTO Up_Vote VALUES(27,3);
INSERT INTO Up_Vote VALUES(27,4);
INSERT INTO Up_Vote VALUES(27,6);
INSERT INTO Up_Vote VALUES(27,8);
INSERT INTO Up_Vote VALUES(27,9);
INSERT INTO Up_Vote VALUES(28,2);
INSERT INTO Up_Vote VALUES(28,4);
INSERT INTO Up_Vote VALUES(28,6);
INSERT INTO Up_Vote VALUES(28,7);
INSERT INTO Up_Vote VALUES(28,8);
INSERT INTO Up_Vote VALUES(28,9);
INSERT INTO Up_Vote VALUES(29,1);
INSERT INTO Up_Vote VALUES(29,10);
INSERT INTO Up_Vote VALUES(29,2);
INSERT INTO Up_Vote VALUES(29,3);
INSERT INTO Up_Vote VALUES(29,4);
INSERT INTO Up_Vote VALUES(29,5);
INSERT INTO Up_Vote VALUES(29,6);
INSERT INTO Up_Vote VALUES(29,8);
INSERT INTO Up_Vote VALUES(3,1);
INSERT INTO Up_Vote VALUES(3,3);
INSERT INTO Up_Vote VALUES(3,4);
INSERT INTO Up_Vote VALUES(3,9);
INSERT INTO Up_Vote VALUES(30,1);
INSERT INTO Up_Vote VALUES(30,2);
INSERT INTO Up_Vote VALUES(30,3);
INSERT INTO Up_Vote VALUES(30,4);
INSERT INTO Up_Vote VALUES(30,5);
INSERT INTO Up_Vote VALUES(30,6);
INSERT INTO Up_Vote VALUES(30,7);
INSERT INTO Up_Vote VALUES(30,8);
INSERT INTO Up_Vote VALUES(30,9);
INSERT INTO Up_Vote VALUES(31,1);
INSERT INTO Up_Vote VALUES(31,2);
INSERT INTO Up_Vote VALUES(31,3);
INSERT INTO Up_Vote VALUES(31,4);
INSERT INTO Up_Vote VALUES(31,5);
INSERT INTO Up_Vote VALUES(31,6);
INSERT INTO Up_Vote VALUES(31,7);
INSERT INTO Up_Vote VALUES(31,9);
INSERT INTO Up_Vote VALUES(32,1);
INSERT INTO Up_Vote VALUES(32,10);
INSERT INTO Up_Vote VALUES(32,2);
INSERT INTO Up_Vote VALUES(32,5);
INSERT INTO Up_Vote VALUES(32,6);
INSERT INTO Up_Vote VALUES(32,7);
INSERT INTO Up_Vote VALUES(32,8);
INSERT INTO Up_Vote VALUES(32,9);
INSERT INTO Up_Vote VALUES(33,10);
INSERT INTO Up_Vote VALUES(33,2);
INSERT INTO Up_Vote VALUES(33,3);
INSERT INTO Up_Vote VALUES(33,4);
INSERT INTO Up_Vote VALUES(33,5);
INSERT INTO Up_Vote VALUES(33,6);
INSERT INTO Up_Vote VALUES(33,8);
INSERT INTO Up_Vote VALUES(33,9);
INSERT INTO Up_Vote VALUES(34,1);
INSERT INTO Up_Vote VALUES(34,10);
INSERT INTO Up_Vote VALUES(34,3);
INSERT INTO Up_Vote VALUES(34,4);
INSERT INTO Up_Vote VALUES(34,6);
INSERT INTO Up_Vote VALUES(34,7);
INSERT INTO Up_Vote VALUES(34,9);
INSERT INTO Up_Vote VALUES(35,10);
INSERT INTO Up_Vote VALUES(35,2);
INSERT INTO Up_Vote VALUES(35,3);
INSERT INTO Up_Vote VALUES(35,4);
INSERT INTO Up_Vote VALUES(35,5);
INSERT INTO Up_Vote VALUES(35,8);
INSERT INTO Up_Vote VALUES(36,1);
INSERT INTO Up_Vote VALUES(36,2);
INSERT INTO Up_Vote VALUES(36,3);
INSERT INTO Up_Vote VALUES(36,4);
INSERT INTO Up_Vote VALUES(36,5);
INSERT INTO Up_Vote VALUES(36,6);
INSERT INTO Up_Vote VALUES(36,7);
INSERT INTO Up_Vote VALUES(37,1);
INSERT INTO Up_Vote VALUES(37,10);
INSERT INTO Up_Vote VALUES(37,2);
INSERT INTO Up_Vote VALUES(37,3);
INSERT INTO Up_Vote VALUES(37,4);
INSERT INTO Up_Vote VALUES(37,6);
INSERT INTO Up_Vote VALUES(37,8);
INSERT INTO Up_Vote VALUES(38,1);
INSERT INTO Up_Vote VALUES(38,10);
INSERT INTO Up_Vote VALUES(38,2);
INSERT INTO Up_Vote VALUES(38,3);
INSERT INTO Up_Vote VALUES(38,4);
INSERT INTO Up_Vote VALUES(38,7);
INSERT INTO Up_Vote VALUES(38,8);
INSERT INTO Up_Vote VALUES(39,1);
INSERT INTO Up_Vote VALUES(39,10);
INSERT INTO Up_Vote VALUES(39,2);
INSERT INTO Up_Vote VALUES(39,4);
INSERT INTO Up_Vote VALUES(39,5);
INSERT INTO Up_Vote VALUES(39,6);
INSERT INTO Up_Vote VALUES(39,7);
INSERT INTO Up_Vote VALUES(39,9);
INSERT INTO Up_Vote VALUES(4,1);
INSERT INTO Up_Vote VALUES(4,10);
INSERT INTO Up_Vote VALUES(4,2);
INSERT INTO Up_Vote VALUES(4,3);
INSERT INTO Up_Vote VALUES(4,4);
INSERT INTO Up_Vote VALUES(4,6);
INSERT INTO Up_Vote VALUES(4,7);
INSERT INTO Up_Vote VALUES(4,8);
INSERT INTO Up_Vote VALUES(4,9);
INSERT INTO Up_Vote VALUES(40,1);
INSERT INTO Up_Vote VALUES(40,3);
INSERT INTO Up_Vote VALUES(40,4);
INSERT INTO Up_Vote VALUES(40,5);
INSERT INTO Up_Vote VALUES(40,6);
INSERT INTO Up_Vote VALUES(40,9);
INSERT INTO Up_Vote VALUES(5,1);
INSERT INTO Up_Vote VALUES(5,10);
INSERT INTO Up_Vote VALUES(5,2);
INSERT INTO Up_Vote VALUES(5,4);
INSERT INTO Up_Vote VALUES(5,8);
INSERT INTO Up_Vote VALUES(5,9);
INSERT INTO Up_Vote VALUES(6,1);
INSERT INTO Up_Vote VALUES(6,10);
INSERT INTO Up_Vote VALUES(6,2);
INSERT INTO Up_Vote VALUES(6,3);
INSERT INTO Up_Vote VALUES(6,4);
INSERT INTO Up_Vote VALUES(6,6);
INSERT INTO Up_Vote VALUES(6,7);
INSERT INTO Up_Vote VALUES(7,1);
INSERT INTO Up_Vote VALUES(7,3);
INSERT INTO Up_Vote VALUES(7,7);
INSERT INTO Up_Vote VALUES(7,8);
INSERT INTO Up_Vote VALUES(7,9);
INSERT INTO Up_Vote VALUES(8,1);
INSERT INTO Up_Vote VALUES(8,3);
INSERT INTO Up_Vote VALUES(8,4);
INSERT INTO Up_Vote VALUES(8,6);
INSERT INTO Up_Vote VALUES(8,8);
INSERT INTO Up_Vote VALUES(8,9);
INSERT INTO Up_Vote VALUES(9,1);
INSERT INTO Up_Vote VALUES(9,10);
INSERT INTO Up_Vote VALUES(9,2);
INSERT INTO Up_Vote VALUES(9,3);
INSERT INTO Up_Vote VALUES(9,4);
INSERT INTO Up_Vote VALUES(9,5);
INSERT INTO Up_Vote VALUES(9,6);
INSERT INTO Up_Vote VALUES(9,8);
--Get Valid ID 
CREATE OR REPLACE FUNCTION GET_NEXT_VALID_ID(OP IN VARCHAR2)
RETURN NUMBER IS
RET NUMBER(10);
BEGIN
	FOR R IN (SELECT * FROM NEXT_VALID_IDS)
	LOOP 
		IF OP = 'USER_ID' THEN 
			RET := R.USER_ID;
			UPDATE NEXT_VALID_IDS SET USER_ID = USER_ID + 1 WHERE USER_ID = RET;
		ELSIF OP = 'POST_ID' THEN 
			RET := R.POST_ID;
			UPDATE NEXT_VALID_IDS SET POST_ID = POST_ID + 1 WHERE POST_ID = RET;
		ELSIF OP = 'CONTEST_ID' THEN 
			RET := R.CONTEST_ID;
			UPDATE NEXT_VALID_IDS SET CONTEST_ID = CONTEST_ID + 1 WHERE CONTEST_ID = RET;
		ELSIF OP = 'COMMUNITY_ID' THEN 
			RET := R.COMMUNITY_ID;
			UPDATE NEXT_VALID_IDS SET COMMUNITY_ID = COMMUNITY_ID + 1 WHERE COMMUNITY_ID = RET;
		ELSIF OP = 'SPONSER_ID' THEN
			RET := R.SPONSER_ID;
			UPDATE NEXT_VALID_IDS SET SPONSER_ID = SPONSER_ID + 1 WHERE SPONSER_ID = RET;
		ELSIF OP = 'TEMPLATE_ID' THEN
			RET := R.TEMPLATE_ID;
			UPDATE NEXT_VALID_IDS SET TEMPLATE_ID = TEMPLATE_ID + 1 WHERE TEMPLATE_ID = RET;
		ELSIF OP = 'COMMENT_ID' THEN
			RET := R.COMMENT_ID;
			UPDATE NEXT_VALID_IDS SET COMMENT_ID = COMMENT_ID + 1 WHERE COMMENT_ID = RET;  
		END IF;
	END LOOP;
	RETURN RET;
END;
/  
BEGIN
	DBMS_OUTPUT.PUT_LINE(GET_NEXT_VALID_ID('COMMENT_ID'));
END;
-- Log In 
-- return user id if match email and pasword and return 0 if don't 
CREATE OR REPLACE FUNCTION LOG_IN(USER_EMAIL IN VARCHAR2,USER_PASSWORD IN VARCHAR2)
RETURN NUMBER IS 
RET NUMBER(10);
ID NUMBER(10);
BEGIN
	RET := 0;
	FOR R IN (SELECT EMAIL,PASSWORD,USER_ID FROM USER_INFO WHERE EMAIL = USER_EMAIL AND PASSWORD = USER_PASSWORD)
	LOOP 
		RET := 1;
		ID := R.USER_ID;
	END LOOP;
	IF RET = 1 THEN
		RETURN ID;
	ELSE 
		RETURN RET;
	END IF;
END;
/
BEGIN
	DBMS_OUTPUT.PUT_LINE(LOG_IN('fihad@gmail.com','fihadpass'));
END;
SELECT * FROM USER_INFO WHERE USER_ID = LOG_IN('fihad@gmail.com','fihadpass');
-- My Profile 
SELECT * FROM USER_INFO WHERE USER_ID = 1;
-- My Figures 
SELECT FIGURE FROM FOLLOW WHERE FOLLOWER = 1;
-- Newsfeed 
SELECT POST_ID,COMMUNITY_ID,CONTEST_ID,AUTHOR_ID,DESCRIPTION,TAG,MEME,POST_TIME FROM POST_INFO JOIN FOLLOW ON (POST_INFO.AUTHOR_ID = FOLLOW.FIGURE) WHERE FOLLOW.FOLLOWER = 1 ORDER BY POST_TIME DESC; 

SELECT PI.POST_ID,UI.PROFILE_PICTURE,PI.POST_TIME,PI.MEME,PI.CONTEST_ID,PI.COMMUNITY_ID,PI.DESCRIPTION,UP_VOTE_COUNT(PI.POST_ID) AS UP_VOTES,UI.NAME,UI.USER_ID FROM FOLLOW F JOIN POST_INFO PI ON (F.FIGURE = PI.AUTHOR_ID) JOIN USER_INFO UI ON (PI.AUTHOR_ID = UI.USER_ID) WHERE F.FOLLOWER = 1 ORDER BY PI.POST_TIME DESC;

SELECT P.POST_ID,U.PROFILE_PICTURE,P.POST_TIME,P.MEME,P.CONTEST_ID,P.COMMUNITY_ID,P.DESCRIPTION,UP_VOTE_COUNT(P.POST_ID) AS UP_VOTES,U.NAME,U.USER_ID FROM POST_INFO P JOIN USER_INFO U ON (P.AUTHOR_ID = U.USER_ID) ORDER BY P.POST_TIME DESC;
-- Running contest 
SELECT * FROM CONTEST_INFO WHERE CONTEST_INFO.START_TIME <= SYSDATE AND CONTEST_INFO.END_TIME >= SYSDATE;
-- Past contest 
SELECT * FROM CONTEST_INFO WHERE CONTEST_INFO.END_TIME <= SYSDATE;
-- User Registration 
CREATE OR REPLACE FUNCTION IS_UNIQUE_USER(USER_EMAIL IN VARCHAR2,USER_NAME IN VARCHAR2)
RETURN NUMBER IS 
RET NUMBER(10);
BEGIN
	RET := 1;
	FOR R IN (SELECT NAME,EMAIL FROM USER_INFO)
	LOOP 
		IF R.NAME = USER_NAME OR R.EMAIL = USER_EMAIL THEN 
			RET := 0;
		END IF;
	END LOOP;
	RETURN RET;
END;
/
-- (USER_ID,EMAIL,PASSWORD,NAME,PROFILE_PICTURE,EARNED_MONEY,SOCIAL_MEDIA_HANDLE)
-- Community Registration 
CREATE OR REPLACE FUNCTION IS_UNIQUE_COMMUNITY(COMMUNITY_NAME IN VARCHAR2)
RETURN NUMBER IS 
RET NUMBER(10);
BEGIN
	RET := 1;
	FOR R IN (SELECT NAME FROM COMMUNITY_INFO)
	LOOP
		IF R.NAME = COMMUNITY_NAME THEN 
			RET := 0;
		END IF;
	END LOOP;
	RETURN RET;
END;
/

BEGIN
	DBMS_OUTPUT.PUT_LINE(IS_UNIQUE_USER('hameem@gmail.com','hamem'));
END;
/
-- (COMMUNITY_ID,NAME,COMMUNITY_IMAGE)
-- Contest Registration 
CREATE OR REPLACE FUNCTION IS_UNIQUE_CONTEST(CON_NAME IN VARCHAR2) RETURN NUMBER IS 
RET NUMBER(10);
BEGIN
	RET := 1;
	FOR R IN (SELECT CONTEST_NAME FROM CONTEST_INFO)
	LOOP 
		IF R.CONTEST_NAME	= CON_NAME THEN 
			RET := 0;
		END IF;
	END LOOP;
	RETURN RET;
END;
/
--(POST_ID,COMMUNITY_ID,CONTEST_ID,AUTHOR_ID,DESCRIPTION,TAG,MEME,POST_TIME)
CREATE OR REPLACE FUNCTION UP_VOTE_COUNT(PID IN NUMBER)
RETURN NUMBER IS 
RET NUMBER(10);
BEGIN
	SELECT COUNT(*) INTO RET FROM UP_VOTE WHERE UP_VOTE.POST_ID = PID;
	RETURN RET;
END;
/
BEGIN
DBMS_OUTPUT.PUT_LINE(UP_VOTE_COUNT(1));
SELECT P.POST_ID, U.PROFILE_PICTURE,P.POST_TIME,P.MEME,P.CONTEST_ID,P.COMMUNITY_ID,P.DESCRIPTION,UP_VOTE_COUNT(P.POST_ID) AS UP_VOTES,U.NAME FROM POST_INFO P JOIN USER_INFO U ON (P.AUTHOR_ID = U.USER_ID) ORDER BY P.POST_TIME DESC;
END;
CREATE OR REPLACE FUNCTION GET_CONTEST_NAME(CID IN NUMBER)
RETURN VARCHAR2 IS 
RET VARCHAR2(100);
BEGIN
	SELECT CONTEST_NAME INTO RET FROM CONTEST_INFO WHERE CONTEST_ID = CID;
	RETURN RET;
END;
/
CREATE OR REPLACE FUNCTION GET_COMMUNITY_NAME(CID IN NUMBER)
RETURN VARCHAR2 IS 
RET VARCHAR2(100);
BEGIN
	SELECT NAME INTO RET FROM COMMUNITY_INFO WHERE COMMUNITY_ID = CID;
	RETURN RET;
END;
/
INSERT INTO ACTIVITIES VALUES(1,21,5,SYSDATE+167,'hoff mama');
INSERT INTO ACTIVITIES VALUES(2,39,9,SYSDATE+224,'bump');
INSERT INTO ACTIVITIES VALUES(3,26,6,SYSDATE+164,'us bhai us');
INSERT INTO ACTIVITIES VALUES(4,12,2,SYSDATE+127,'hoff mama');
INSERT INTO ACTIVITIES VALUES(5,37,8,SYSDATE+242,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(6,34,3,SYSDATE+104,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(7,37,2,SYSDATE+282,'under rated');
INSERT INTO ACTIVITIES VALUES(8,7,8,SYSDATE+195,'so real');
INSERT INTO ACTIVITIES VALUES(9,33,10,SYSDATE+238,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(10,15,6,SYSDATE+199,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(11,14,3,SYSDATE+111,'khub relatable');
INSERT INTO ACTIVITIES VALUES(12,32,2,SYSDATE+164,'context?');
INSERT INTO ACTIVITIES VALUES(13,5,8,SYSDATE+168,'context?');
INSERT INTO ACTIVITIES VALUES(14,20,8,SYSDATE+257,'us bhai us');
INSERT INTO ACTIVITIES VALUES(15,19,10,SYSDATE+241,'khub relatable');
INSERT INTO ACTIVITIES VALUES(16,3,1,SYSDATE+135,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(17,23,1,SYSDATE+206,'tore samne paile pidamu');
INSERT INTO ACTIVITIES VALUES(18,6,7,SYSDATE+148,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(19,31,1,SYSDATE+229,'pl bara');
INSERT INTO ACTIVITIES VALUES(20,29,4,SYSDATE+201,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(21,35,5,SYSDATE+123,'bump');
INSERT INTO ACTIVITIES VALUES(22,17,7,SYSDATE+140,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(23,40,5,SYSDATE+208,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(24,19,8,SYSDATE+223,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(25,22,10,SYSDATE+182,'so real');
INSERT INTO ACTIVITIES VALUES(26,19,10,SYSDATE+215,'context?');
INSERT INTO ACTIVITIES VALUES(27,27,8,SYSDATE+230,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(28,26,2,SYSDATE+286,'context?');
INSERT INTO ACTIVITIES VALUES(29,30,1,SYSDATE+172,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(30,33,8,SYSDATE+273,'triggered!!');
INSERT INTO ACTIVITIES VALUES(31,37,2,SYSDATE+190,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(32,15,6,SYSDATE+267,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(33,31,1,SYSDATE+152,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(34,31,7,SYSDATE+224,'hoff mama');
INSERT INTO ACTIVITIES VALUES(35,18,8,SYSDATE+291,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(36,24,4,SYSDATE+187,'triggered!!');
INSERT INTO ACTIVITIES VALUES(37,39,10,SYSDATE+209,'baje hoise');
INSERT INTO ACTIVITIES VALUES(38,27,3,SYSDATE+288,'hoff mama');
INSERT INTO ACTIVITIES VALUES(39,9,4,SYSDATE+130,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(40,16,3,SYSDATE+291,'are vy agun agun');
INSERT INTO ACTIVITIES VALUES(41,18,5,SYSDATE+259,'pl bara');
INSERT INTO ACTIVITIES VALUES(42,2,6,SYSDATE+183,'tore samne paile pidamu');
INSERT INTO ACTIVITIES VALUES(43,37,2,SYSDATE+250,'us bhai us');
INSERT INTO ACTIVITIES VALUES(44,22,7,SYSDATE+120,'wth!');
INSERT INTO ACTIVITIES VALUES(45,5,9,SYSDATE+299,'tore samne paile pidamu');
INSERT INTO ACTIVITIES VALUES(46,40,4,SYSDATE+234,'hoff mama');
INSERT INTO ACTIVITIES VALUES(47,29,1,SYSDATE+238,'so real');
INSERT INTO ACTIVITIES VALUES(48,14,9,SYSDATE+167,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(49,22,8,SYSDATE+183,'tore samne paile pidamu');
INSERT INTO ACTIVITIES VALUES(50,35,4,SYSDATE+117,'pl bara');
INSERT INTO ACTIVITIES VALUES(51,12,6,SYSDATE+116,'bump');
INSERT INTO ACTIVITIES VALUES(52,37,10,SYSDATE+149,'are vy agun agun');
INSERT INTO ACTIVITIES VALUES(53,9,5,SYSDATE+203,'so real');
INSERT INTO ACTIVITIES VALUES(54,23,10,SYSDATE+109,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(55,24,4,SYSDATE+185,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(56,24,5,SYSDATE+287,'khub relatable');
INSERT INTO ACTIVITIES VALUES(57,19,9,SYSDATE+100,'tore samne paile pidamu');
INSERT INTO ACTIVITIES VALUES(58,2,9,SYSDATE+296,'are vy agun agun');
INSERT INTO ACTIVITIES VALUES(59,38,10,SYSDATE+298,'bump');
INSERT INTO ACTIVITIES VALUES(60,13,9,SYSDATE+122,'under rated');
INSERT INTO ACTIVITIES VALUES(61,18,1,SYSDATE+279,'so real');
INSERT INTO ACTIVITIES VALUES(62,9,6,SYSDATE+291,'so real');
INSERT INTO ACTIVITIES VALUES(63,35,3,SYSDATE+211,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(64,7,9,SYSDATE+155,'under rated');
INSERT INTO ACTIVITIES VALUES(65,34,6,SYSDATE+186,'us bhai us');
INSERT INTO ACTIVITIES VALUES(66,17,5,SYSDATE+242,'bump');
INSERT INTO ACTIVITIES VALUES(67,12,3,SYSDATE+298,'hoff mama');
INSERT INTO ACTIVITIES VALUES(68,37,8,SYSDATE+199,'hoff mama');
INSERT INTO ACTIVITIES VALUES(69,33,6,SYSDATE+289,'under rated');
INSERT INTO ACTIVITIES VALUES(70,30,4,SYSDATE+210,'are vy agun agun');
INSERT INTO ACTIVITIES VALUES(71,30,2,SYSDATE+188,'hoff mama');
INSERT INTO ACTIVITIES VALUES(72,26,3,SYSDATE+123,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(73,27,9,SYSDATE+185,'us bhai us');
INSERT INTO ACTIVITIES VALUES(74,13,3,SYSDATE+257,'triggered!!');
INSERT INTO ACTIVITIES VALUES(75,30,2,SYSDATE+254,'bump');
INSERT INTO ACTIVITIES VALUES(76,13,9,SYSDATE+229,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(77,30,5,SYSDATE+255,'baje hoise');
INSERT INTO ACTIVITIES VALUES(78,21,6,SYSDATE+212,'hoff mama');
INSERT INTO ACTIVITIES VALUES(79,24,10,SYSDATE+253,'so real');
INSERT INTO ACTIVITIES VALUES(80,10,8,SYSDATE+296,'vai ki titumir e thaken naki??');
INSERT INTO ACTIVITIES VALUES(81,30,7,SYSDATE+137,'bump');
INSERT INTO ACTIVITIES VALUES(82,17,8,SYSDATE+295,'context?');
INSERT INTO ACTIVITIES VALUES(83,3,9,SYSDATE+205,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(84,22,5,SYSDATE+234,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(85,24,7,SYSDATE+171,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(86,14,6,SYSDATE+255,'context?');
INSERT INTO ACTIVITIES VALUES(87,26,3,SYSDATE+108,'under rated');
INSERT INTO ACTIVITIES VALUES(88,39,2,SYSDATE+256,'context?');
INSERT INTO ACTIVITIES VALUES(89,25,2,SYSDATE+282,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(90,2,10,SYSDATE+122,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(91,27,4,SYSDATE+150,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(92,40,3,SYSDATE+159,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(93,31,5,SYSDATE+124,'context?');
INSERT INTO ACTIVITIES VALUES(94,34,7,SYSDATE+149,'baje hoise');
INSERT INTO ACTIVITIES VALUES(95,19,9,SYSDATE+122,'wth!');
INSERT INTO ACTIVITIES VALUES(96,32,9,SYSDATE+205,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(97,15,8,SYSDATE+125,'us bhai us');
INSERT INTO ACTIVITIES VALUES(98,35,5,SYSDATE+124,'wth!');
INSERT INTO ACTIVITIES VALUES(99,31,4,SYSDATE+259,'under rated');
INSERT INTO ACTIVITIES VALUES(100,18,9,SYSDATE+197,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(101,29,4,SYSDATE+170,'context?');
INSERT INTO ACTIVITIES VALUES(102,1,3,SYSDATE+285,'under rated');
INSERT INTO ACTIVITIES VALUES(103,20,3,SYSDATE+127,'context?');
INSERT INTO ACTIVITIES VALUES(104,5,4,SYSDATE+125,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(105,22,2,SYSDATE+272,'khub relatable');
INSERT INTO ACTIVITIES VALUES(106,34,6,SYSDATE+132,'khub relatable');
INSERT INTO ACTIVITIES VALUES(107,23,3,SYSDATE+131,'baje hoise');
INSERT INTO ACTIVITIES VALUES(108,21,5,SYSDATE+186,'us bhai us');
INSERT INTO ACTIVITIES VALUES(109,15,4,SYSDATE+260,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(110,34,6,SYSDATE+270,'pl bara');
INSERT INTO ACTIVITIES VALUES(111,28,7,SYSDATE+260,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(112,15,1,SYSDATE+250,'baje hoise');
INSERT INTO ACTIVITIES VALUES(113,6,10,SYSDATE+124,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(114,23,9,SYSDATE+194,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(115,34,9,SYSDATE+166,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(116,25,9,SYSDATE+184,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(117,8,1,SYSDATE+252,'vai ki titumir e thaken naki??');
INSERT INTO ACTIVITIES VALUES(118,38,1,SYSDATE+226,'are vy agun agun');
INSERT INTO ACTIVITIES VALUES(119,28,7,SYSDATE+215,'pl bara');
INSERT INTO ACTIVITIES VALUES(120,30,5,SYSDATE+258,'khub relatable');
INSERT INTO ACTIVITIES VALUES(121,8,6,SYSDATE+186,'us bhai us');
INSERT INTO ACTIVITIES VALUES(122,28,6,SYSDATE+174,'triggered!!');
INSERT INTO ACTIVITIES VALUES(123,1,4,SYSDATE+228,'bump');
INSERT INTO ACTIVITIES VALUES(124,37,4,SYSDATE+262,'us bhai us');
INSERT INTO ACTIVITIES VALUES(125,6,6,SYSDATE+161,'triggered!!');
INSERT INTO ACTIVITIES VALUES(126,37,3,SYSDATE+160,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(127,12,2,SYSDATE+226,'pl bara');
INSERT INTO ACTIVITIES VALUES(128,1,4,SYSDATE+247,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(129,4,9,SYSDATE+224,'pl bara');
INSERT INTO ACTIVITIES VALUES(130,30,3,SYSDATE+151,'are vy agun agun');
INSERT INTO ACTIVITIES VALUES(131,19,9,SYSDATE+213,'are vy agun agun');
INSERT INTO ACTIVITIES VALUES(132,1,8,SYSDATE+107,'baje hoise');
INSERT INTO ACTIVITIES VALUES(133,1,4,SYSDATE+139,'so real');
INSERT INTO ACTIVITIES VALUES(134,29,8,SYSDATE+224,'triggered!!');
INSERT INTO ACTIVITIES VALUES(135,11,2,SYSDATE+187,'context?');
INSERT INTO ACTIVITIES VALUES(136,25,4,SYSDATE+128,'are vy agun agun');
INSERT INTO ACTIVITIES VALUES(137,25,2,SYSDATE+240,'baje hoise');
INSERT INTO ACTIVITIES VALUES(138,31,3,SYSDATE+256,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(139,17,7,SYSDATE+185,'khub relatable');
INSERT INTO ACTIVITIES VALUES(140,38,7,SYSDATE+257,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(141,2,10,SYSDATE+171,'triggered!!');
INSERT INTO ACTIVITIES VALUES(142,33,8,SYSDATE+122,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(143,2,6,SYSDATE+196,'triggered!!');
INSERT INTO ACTIVITIES VALUES(144,6,10,SYSDATE+229,'khub relatable');
INSERT INTO ACTIVITIES VALUES(145,16,7,SYSDATE+232,'vai ki titumir e thaken naki??');
INSERT INTO ACTIVITIES VALUES(146,15,5,SYSDATE+262,'context?');
INSERT INTO ACTIVITIES VALUES(147,10,8,SYSDATE+272,'wth!');
INSERT INTO ACTIVITIES VALUES(148,4,8,SYSDATE+263,'under rated');
INSERT INTO ACTIVITIES VALUES(149,9,8,SYSDATE+135,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(150,23,4,SYSDATE+238,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(151,16,2,SYSDATE+211,'wth!');
INSERT INTO ACTIVITIES VALUES(152,31,2,SYSDATE+125,'vai ki titumir e thaken naki??');
INSERT INTO ACTIVITIES VALUES(153,24,6,SYSDATE+234,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(154,22,10,SYSDATE+298,'pl bara');
INSERT INTO ACTIVITIES VALUES(155,15,8,SYSDATE+234,'context?');
INSERT INTO ACTIVITIES VALUES(156,26,7,SYSDATE+293,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(157,21,2,SYSDATE+248,'us bhai us');
INSERT INTO ACTIVITIES VALUES(158,16,6,SYSDATE+141,'context?');
INSERT INTO ACTIVITIES VALUES(159,38,2,SYSDATE+162,'us bhai us');
INSERT INTO ACTIVITIES VALUES(160,4,3,SYSDATE+178,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(161,34,1,SYSDATE+173,'eta ki silo vy!');
INSERT INTO ACTIVITIES VALUES(162,11,9,SYSDATE+172,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(163,16,3,SYSDATE+232,'triggered!!');
INSERT INTO ACTIVITIES VALUES(164,9,1,SYSDATE+131,'bump');
INSERT INTO ACTIVITIES VALUES(165,30,8,SYSDATE+190,'baje hoise');
INSERT INTO ACTIVITIES VALUES(166,35,4,SYSDATE+245,'pl bara');
INSERT INTO ACTIVITIES VALUES(167,19,5,SYSDATE+240,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(168,6,3,SYSDATE+259,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(169,30,4,SYSDATE+281,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(170,38,3,SYSDATE+108,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(171,28,2,SYSDATE+256,'bump');
INSERT INTO ACTIVITIES VALUES(172,1,10,SYSDATE+241,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(173,38,2,SYSDATE+274,'context?');
INSERT INTO ACTIVITIES VALUES(174,33,4,SYSDATE+183,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(175,40,3,SYSDATE+101,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(176,5,8,SYSDATE+128,'pl bara');
INSERT INTO ACTIVITIES VALUES(177,11,9,SYSDATE+286,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(178,24,5,SYSDATE+147,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(179,4,7,SYSDATE+163,'hoff mama');
INSERT INTO ACTIVITIES VALUES(180,1,10,SYSDATE+271,'pl bara');
INSERT INTO ACTIVITIES VALUES(181,34,10,SYSDATE+242,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(182,33,9,SYSDATE+204,'interbal 18 er dristy akorshon korchi');
INSERT INTO ACTIVITIES VALUES(183,20,6,SYSDATE+105,'pl bara');
INSERT INTO ACTIVITIES VALUES(184,8,9,SYSDATE+122,'khub relatable');
INSERT INTO ACTIVITIES VALUES(185,25,2,SYSDATE+148,'god level sense of humour');
INSERT INTO ACTIVITIES VALUES(186,33,6,SYSDATE+175,'context?');
INSERT INTO ACTIVITIES VALUES(187,23,10,SYSDATE+178,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(188,25,10,SYSDATE+285,'vai ki titumir e thaken naki??');
INSERT INTO ACTIVITIES VALUES(189,29,6,SYSDATE+240,'baje hoise');
INSERT INTO ACTIVITIES VALUES(190,4,2,SYSDATE+170,'so real');
INSERT INTO ACTIVITIES VALUES(191,8,3,SYSDATE+172,'under rated');
INSERT INTO ACTIVITIES VALUES(192,24,2,SYSDATE+263,'pl bara');
INSERT INTO ACTIVITIES VALUES(193,10,1,SYSDATE+227,'khub relatable');
INSERT INTO ACTIVITIES VALUES(194,24,9,SYSDATE+265,'edike kichue na bojha ami');
INSERT INTO ACTIVITIES VALUES(195,38,4,SYSDATE+188,'haste haste more gelam');
INSERT INTO ACTIVITIES VALUES(196,2,10,SYSDATE+163,'bump');
INSERT INTO ACTIVITIES VALUES(197,21,9,SYSDATE+242,'tore samne paile pidamu');
INSERT INTO ACTIVITIES VALUES(198,9,5,SYSDATE+258,'hoff mama');
INSERT INTO ACTIVITIES VALUES(199,4,10,SYSDATE+190,'3rd class jokes');
INSERT INTO ACTIVITIES VALUES(200,28,9,SYSDATE+120,'pl bara');
-- PRESENTING INFO OF A POST 
SELECT P.MEME,P.DESCRIPTION,U.NAME,U.PROFILE_PICTURE FROM POST_INFO P JOIN USER_INFO U ON (P.AUTHOR_ID = U.USER_ID) WHERE POST_ID = 1;
-- COMMENTS IN A POST 
SELECT A.DESCRIPTION,A.TIME,U.NAME,U.PROFILE_PICTURE,A.COMMENT_ID FROM ACTIVITIES A JOIN USER_INFO U ON (A.AUTHOR_ID = U.USER_ID) WHERE A.POST_ID = 1;
--
SELECT * FROM CONTEST_INFO CI JOIN SPONSER_INFO SI ON (CI.SPONSER_ID = SI.SPONSER_ID) JOIN USER_INFO UI ON (CI.HOST_ID = UI.USER_ID);
-- RANKING
CREATE OR REPLACE FUNCTION POST_COUNT(PID IN NUMBER,CID IN NUMBER)
RETURN NUMBER IS 
RET NUMBER(10);
BEGIN
	SELECT COUNT(*) INTO RET FROM POST_INFO WHERE AUTHOR_ID = PID AND CONTEST_ID = CID;
	RETURN RET;
END;
/
CREATE OR REPLACE FUNCTION COMMENT_COUNT(PID IN NUMBER,CID IN NUMBER)
RETURN NUMBER IS 
RET NUMBER(10);
BEGIN
	SELECT COUNT(*) INTO RET FROM POST_INFO JOIN ACTIVITIES ON (POST_INFO.POST_ID = ACTIVITIES.POST_ID) WHERE POST_INFO.CONTEST_ID = CID AND POST_INFO.AUTHOR_ID = PID AND ACTIVITIES.AUTHOR_ID <> PID;
	RETURN RET;
END;
/
CREATE OR REPLACE FUNCTION UPVOTE_COUNT(PID IN NUMBER,CID IN NUMBER)
RETURN NUMBER IS 
RET NUMBER(10);
BEGIN
	RET := 0;
	FOR R IN (SELECT * FROM POST_INFO PI JOIN UP_VOTE UI ON (PI.POST_ID = UI.POST_ID) WHERE PI.AUTHOR_ID = PID AND PI.CONTEST_ID = CID)
	LOOP 
		RET := RET + 1;
	END LOOP;
	RETURN RET;
END;
/
CREATE OR REPLACE FUNCTION SCORING(PID IN NUMBER,CID IN NUMBER)
RETURN NUMBER IS 
RET NUMBER(10,3);
BEGIN
	RET := (45*UPVOTE_COUNT(PID,CID)/POST_COUNT(PID,CID)+35*COMMENT_COUNT(PID,CID)/POST_COUNT(PID,CID)+20*POST_COUNT(PID,CID))/10;
	RETURN RET;
END;
/
SELECT DISTINCT UI.NAME,UI.PROFILE_PICTURE, MEMER_ID, UPVOTE_COUNT(UI.USER_ID,1) AS TOTAL_UPVOTES, POST_COUNT(UI.USER_ID,1) AS TOTAL_POSTS,COMMENT_COUNT(UI.USER_ID,1) AS TOTAL_COMMENTS, SCORING(UI.USER_ID,1) AS SCORE FROM CONTEST_REGISTRATION CR JOIN USER_INFO UI ON (MEMER_ID = UI.USER_ID) WHERE CR.CONTEST_ID = 1 ORDER BY SCORE DESC,TOTAL_UPVOTES DESC;
-- CONTEST PAGE MEME 
SELECT P.POST_ID, U.PROFILE_PICTURE,P.POST_TIME,P.MEME,P.CONTEST_ID,P.COMMUNITY_ID,P.DESCRIPTION,UP_VOTE_COUNT(P.POST_ID) AS UP_VOTES,U.NAME FROM POST_INFO P JOIN USER_INFO U ON (P.AUTHOR_ID = U.USER_ID) WHERE P.CONTEST_ID = 1 ORDER BY P.POST_TIME DESC;
-- community banner 
SELECT CI.COMMUNITY_ID,CI.NAME,CI.COMMUNITY_IMAGE,UI.NAME,UI.PROFILE_PICTURE,CI.ADMIN_ID FROM COMMUNITY_INFO CI JOIN USER_INFO UI ON (CI.ADMIN_ID = UI.USER_ID);
-- posts in a community 
SELECT P.POST_ID, U.PROFILE_PICTURE,P.POST_TIME,P.MEME,P.CONTEST_ID,P.COMMUNITY_ID,P.DESCRIPTION,UP_VOTE_COUNT(P.POST_ID) AS UP_VOTES,U.NAME FROM POST_INFO P JOIN USER_INFO U ON (P.AUTHOR_ID = U.USER_ID) WHERE P.COMMUNITY_ID = 1 ORDER BY P.POST_TIME DESC;
-- community memebers 
SELECT UI.NAME,UI.PROFILE_PICTURE FROM USER_INFO UI JOIN COMMUNITY C ON (UI.USER_ID = C.MEMBER_ID) WHERE C.COMMUNITY_ID = 1; 
SELECT PROFILE_PICTURE FROM USER_INFO WHERE USER_ID = 3;
-- user posts in his/her profile 
SELECT P.POST_ID, U.PROFILE_PICTURE,P.POST_TIME,P.MEME,P.CONTEST_ID,P.COMMUNITY_ID,P.DESCRIPTION,UP_VOTE_COUNT(P.POST_ID) AS UP_VOTES,U.NAME FROM POST_INFO P JOIN USER_INFO U ON (P.AUTHOR_ID = U.USER_ID) WHERE U.USER_ID = 1 ORDER BY P.POST_TIME DESC;
-- following 
SELECT F.FIGURE,U.NAME, U.PROFILE_PICTURE FROM FOLLOW F JOIN USER_INFO U ON (F.FOLLOWER = U.USER_ID) WHERE F.FIGURE = 1; 
-- profile info 
SELECT U.NAME, U.PROFILE_PICTURE,U.DESCRIPTION,U.EARNED_MONEY FROM USER_INFO U WHERE U.USER_ID = 1;
-- up vote 
INSERT INTO Up_Vote VALUES(1,1);
CREATE OR REPLACE FUNCTION IS_UP_VOTED(POID IN NUMBER,USID IN NUMBER)
RETURN NUMBER IS 
RET NUMBER(10);
BEGIN
	RET := 0;
	FOR R IN (SELECT * FROM UP_VOTE)
	LOOP 
		IF R.POST_ID = POID AND R.AUTHOR_ID = USID THEN 
				RET := 1;
		END IF;
	END LOOP;
	RETURN RET;
END;
/
BEGIN
	DBMS_OUTPUT.PUT_LINE(IS_UP_VOTED(1,6));
END;
SELECT POST_ID, AUTHOR_ID FROM POST_INFO WHERE POST_ID = 6 AND AUTHOR_ID = 1;
-- up vote a post 
INSERT INTO Up_Vote VALUES(1,1);
COMMIT;
-- remove upvote 
DELETE FROM UP_VOTE WHERE UP_VOTE.AUTHOR_ID = 1 AND UP_VOTE.POST_ID = 1;
SELECT * FROM UP_VOTE WHERE UP_VOTE.AUTHOR_ID = 2 AND UP_VOTE.POST_ID = 40;
-- insert comment 
INSERT INTO ACTIVITIES VALUES(GET_NEXT_VALID_ID('COMMENT_ID'),2,3,SYSDATE+123,'are sera');
-- update comment 
UPDATE ACTIVITIES SET DESCRIPTION = 'hello mama' WHERE COMMENT_ID = 206;
-- delete comment 
DELETE FROM ACTIVITIES WHERE COMMENT_ID = 206;
-- follow option check 
SELECT * FROM FOLLOW WHERE FIGURE = 1 AND FOLLOWER = 2;
-- follw a person 
INSERT INTO FOLLOW VALUES(1,2);
-- unfollw a person 
DELETE FROM FOLLOW WHERE FIGURE = 1 AND FOLLOWER = 2;
-- create a post 
-- (POST_ID,COMMUNITY_ID,CONTEST_ID,AUTHOR_ID,DESCRIPTION,TAG,MEME,POST_TIME)
INSERT INTO POST_INFO VALUES (GET_NEXT_VALID_ID('POST_ID'),NULL,NULL,1,'HELLO','TAG','IMAGE.JPG',SYSDATE);
-- registraion a contest 
-- (CONTEST_ID,HOST_ID,CONTEST_NAME,SPONSER_ID,PRIZE_MONEY,START_TIME,END_TIME,REGISTRATION_FEE)
INSERT INTO CONTEST_INFO VALUES (GET_NEXT_VALID_ID('CONTEST_ID'),1,'name',1,10000,SYSDATE,SYSDATE+6,30);
-- all sponser showing 
SELECT * FROM SPONSER_INFO;
-- registration a community 
-- (COMMUNITY_ID,NAME,ADMIN_ID,IMAGE)
INSERT INTO COMMUNITY_INFO VALUES(GET_NEXT_VALID_ID('COMMUNITY_ID'),'NAME',1,'image');
-- sponser registration 
-- (SPONSER_ID,NAME,WALPAPER,LOGO)
INSERT INTO SPONSER_INFO VALUES(GET_NEXT_VALID_ID('SPONSER_ID'),'NAME',walpaper,NULL);
-- search 
BEGIN	
 DBMS_OUTPUT.PUT_LINE(UTL_MATCH.EDIT_DISTANCE('awesh', 'awesh'));
END;
/
-- PROFILE SEARCH 
SELECT U.USER_ID,U.NAME,U.PROFILE_PICTURE FROM USER_INFO U WHERE UTL_MATCH.EDIT_DISTANCE(U.NAME, 'taky') <= 4 ORDER BY UTL_MATCH.EDIT_DISTANCE(U.NAME, 'taky') ASC; 
-- CONTEST SERACH 
SELECT CI.CONTEST_ID,CI.CONTEST_NAME,SI.WALPAPER FROM CONTEST_INFO CI JOIN SPONSER_INFO SI ON (CI.SPONSER_ID = SI.SPONSER_ID) WHERE UTL_MATCH.EDIT_DISTANCE(CI.CONTEST_NAME, 'ungabunga') <= 4;  
-- COMMUNITY SEARCH 
SELECT CI.COMMUNITY_ID,CI.NAME,CI.COMMUNITY_IMAGE FROM COMMUNITY_INFO CI WHERE UTL_MATCH.EDIT_DISTANCE(CI.NAME, 'usbhaius') <= 4;
-- template upload 
-- (TEMPLATE_ID,CONTENT,UPLOADED_BY)
INSERT INTO TEMPLATES_INFO VALUES(GET_NEXT_VALID_ID('TEMPLATE_ID'),'image',1);

SELECT * FROM TEMPLATES_INFO;
-- user details 
SELECT UI.NAME,UI.EMAIL,UI.PROFILE_PICTURE,UI.DESCRIPTION FROM USER_INFO UI WHERE UI.USER_ID = 1;
-- profile picture update 
SELECT * FROM USER_INFO WHERE USER_ID = 1;
UPDATE USER_INFO SET PROFILE_PICTURE = '1.jpeg' WHERE USER_ID = 1;
UPDATE USER_INFO SET EMAIL = 'hameem@gmail.com' WHERE USER_ID = 1; 
UPDATE USER_INFO SET DESCRIPTION = 'noob ami noob' WHERE USER_ID = 1;
UPDATE USER_INFO SET PASSWORD = 'hameempass' WHERE USER_ID = 1;
UPDATE USER_INFO SET NAME = 'hameem' WHERE USER_ID = 1;
-- is unique user 
SELECT * FROM USER_INFO WHERE NAME = 'hameem';
SELECT * FROM USER_INFO WHERE EMAIL = 'hameem@gmail.com';

-- user sign up 
-- (USER_ID,EMAIL,PASSWORD,NAME,PROFILE_PICTURE,DESCRIPTION,EARNED_MONEY,SOCIAL_MEDIA_HANDLE)
INSERT INTO User_Info VALUES (GET_NEXT_VALID_ID('USER_ID'),'hameem@gmail.com','hameempass','hameem',NULL,NULL,0,'hameem');
-- notification table 
CREATE TABLE Notification(
	Notified_To NUMBER(10) NOT NULL,
	Notified_By NUMBER(10) NOT NULL,
	Notification_Type VARCHAR2(10),
	Post_Id NUMBER(10),
	Time DATE,
	FOREIGN KEY(Notified_To) References USER_INFO (User_ID),
	FOREIGN KEY(Notified_By) References USER_INFO (User_ID),
	FOREIGN KEY(Post_ID) References POST_INFO (Post_ID)
);
-- trigger for follow notification 
CREATE OR REPLACE TRIGGER Follow_Notify BEFORE INSERT ON FOLLOW
FOR EACH ROW 
BEGIN
	INSERT INTO NOTIFICATION VALUES(:NEW.FIGURE,:NEW.FOLLOWER,'follow',NULL,SYSDATE); 
END;
/
-- trigger for up_vote notification 
CREATE OR REPLACE TRIGGER Up_Vote_Notify BEFORE INSERT ON UP_VOTE
FOR EACH ROW 
DECLARE 
DUM_ID NUMBER(10);
BEGIN
	SELECT AUTHOR_ID INTO DUM_ID FROM POST_INFO WHERE POST_ID = :NEW.POST_ID;
	INSERT INTO NOTIFICATION VALUES(DUM_ID,:NEW.AUTHOR_ID,'up_vote',:NEW.POST_ID,SYSDATE);
END;
/
-- trigger for comment notification 
CREATE OR REPLACE TRIGGER Comment_Notify BEFORE INSERT ON ACTIVITIES
FOR EACH ROW 
DECLARE
DUM_ID NUMBER(10);
BEGIN
	SELECT AUTHOR_ID INTO DUM_ID FROM POST_INFO WHERE POST_ID = :NEW.POST_ID;
	INSERT INTO NOTIFICATION VALUES(DUM_ID,:NEW.AUTHOR_ID,'comment',:NEW.POST_ID,SYSDATE);
END;
/
DELETE FROM ACTIVITIES;
DELETE FROM FOLLOW;
DELETE FROM UP_VOTE;
-- notifications of the current user 
SELECT N.NOTIFICATION_TYPE,N.NOTIFIED_BY,N.NOTIFIED_TO,N.POST_ID,UI.NAME,UI.PROFILE_PICTURE FROM NOTIFICATION N
JOIN USER_INFO UI 
ON UI.USER_ID = N.NOTIFIED_BY
WHERE NOTIFIED_TO = 2 and NOTIFIED_BY = 1
ORDER BY N.TIME DESC;
-- TRIGGER FOR DELETING A POST 
CREATE OR REPLACE TRIGGER POST_DELETE BEFORE DELETE ON POST_INFO 
FOR EACH ROW 
DECLARE 
BEGIN
	DELETE FROM ACTIVITIES WHERE ACTIVITIES.POST_ID = :OLD.POST_ID;
	DELETE FROM UP_VOTE WHERE UP_VOTE.POST_ID = :OLD.POST_ID;
	DELETE FROM NOTIFICATION WHERE NOTIFICATION.POST_ID = :OLD.POST_ID;
END;
/
DELETE FROM POST_INFO WHERE POST_ID = 1;
-- TRIGGER FOR DELETING A COMMUNITY
CREATE OR REPLACE TRIGGER COMMUNITY_DELETE BEFORE DELETE ON COMMUNITY_INFO 
FOR EACH ROW 
DECLARE
BEGIN 
	DELETE FROM COMMUNITY WHERE COMMUNITY_ID = :OLD.COMMUNITY_ID;
	DELETE FROM POST_INFO WHERE COMMUNITY_ID = :OLD.COMMUNITY_ID;
END;
/
DELETE FROM COMMUNITY_INFO WHERE COMMUNITY_ID = 1;
-- TRIGGER FOR  DELETING A CONTEST  
CREATE OR REPLACE TRIGGER CONTEST_DELETE BEFORE DELETE ON CONTEST_INFO
FOR EACH ROW 
DECLARE
BEGIN
	DELETE FROM CONTEST_REGISTRATION WHERE CONTEST_ID = :OLD.CONTEST_ID;
	DELETE FROM POST_INFO WHERE CONTEST_ID = :OLD.CONTEST_ID;
END;
/
DELETE FROM CONTEST_INFO WHERE CONTEST_ID = 1;
-- TRIGGER FOR DELETING A USER 
CREATE OR REPLACE TRIGGER USER_DELETE BEFORE DELETE ON USER_INFO
FOR EACH ROW 
DECLARE
BEGIN
	DELETE FROM UP_VOTE WHERE AUTHOR_ID = :OLD.USER_ID;
	DELETE FROM ACTIVITIES WHERE AUTHOR_ID = :OLD.USER_ID;
	DELETE FROM POST_INFO WHERE AUTHOR_ID = :OLD.USER_ID;
	DELETE FROM CONTEST_INFO WHERE HOST_ID = :OLD.USER_ID;
	DELETE FROM COMMUNITY WHERE MEMBER_ID = :OLD.USER_ID;
	DELETE FROM COMMUNITY_INFO WHERE ADMIN_ID = :OLD.USER_ID; 
	DELETE FROM TEMPLATES_INFO WHERE UPLOADED_BY = :OLD.USER_ID;
	DELETE FROM FOLLOW WHERE FOLLOWER = :OLD.USER_ID OR FIGURE = :OLD.USER_ID;
	DELETE FROM CONTEST_REGISTRATION WHERE MEMER_ID = :OLD.USER_ID;
	DELETE FROM NOTIFICATION WHERE NOTIFIED_BY = :OLD.USER_ID OR NOTIFIED_TO = :OLD.USER_ID;
END;
/
--Post DELETE
DELETE FROM POST_INFO WHERE POST_ID = 1;
--User DELETE
DELETE FROM USER_INFO WHERE USER_ID = 1;
-- upload a template 
-- (TEMPLATE_ID,CONTENT,UPLOADED_BY)
INSERT INTO Templates_Info VALUES(GET_NEXT_VALID_ID('TEMPLATE_ID'),'image.jpg',1);
--
UPDATE POST_INFO SET DESCRIPTION = 'min khuje pai na' WHERE POST_ID = 1;
SELECT * FROM POST_INFO WHERE POST_ID = 1;
-- is in a COMMUNITY
SELECT * FROM COMMUNITY WHERE COMMUNITY_ID = 1 AND MEMBER_ID = 1;
-- join a COMMUNITY
-- (COMMUNITY_ID,MEMBER_ID)
INSERT INTO COMMUNITY VALUES(1,1);
SELECT * FROM COMMUNITY;
-- contest is running 
SELECT * FROM CONTEST_INFO WHERE SYSDATE >= START_TIME AND SYSDATE <= END_TIME AND CONTEST_ID = 3;
-- check registration in a contest 
SELECT * FROM CONTEST_REGISTRATION WHERE MEMER_ID = 6 AND CONTEST_ID = 1;
-- registration in a contest 
INSERT INTO CONTEST_REGISTRATION VALUES(cid,mid,0);
-- profile stats 
SELECT PI.POST_ID, (SELECT COUNT(*) FROM ACTIVITIES A WHERE A.POST_ID = PI.POST_ID) AS COMMENTS, (SELECT COUNT(*) FROM UP_VOTE U WHERE U.POST_ID = PI.POST_ID) AS VOTES FROM POST_INFO PI WHERE AUTHOR_ID = 1 ORDER BY POST_TIME ASC;
-- DELETE a contest 
DELETE FROM CONTEST_INFO WHERE CONTEST_ID = 1;
-- DELETE a COMMUNITY
DELETE FROM COMMUNITY_INFO WHERE COMMUNITY_ID = 1;